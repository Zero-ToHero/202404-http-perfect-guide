# 13장 다이제스트 인증

## 정보보안의 요소
- 무결성
    - 항상 데이터가 정상 상태임을 보장한다.
    - 무결성을 보장하기 위해 해시 사용
- 기밀성
    - 허가된 사람만 데이터에 접근 가능하다.
- 가용성
- 해시 값 비교를 통해 원본 데이터가 손상되거나 변조되지 않았음을 확인할 수 있다. (무결성 보장)

## 해시의 개념
- 해시 : 입력 데이터를 해시 알고리즘을 통해 특정 길이의 데이터로 변환하는 함수
- 해시 함수의 특성
  - 제1 역상 저항성 (Preimage Resistance)
    - 주어진 해시 값을 통해 원래의 입력 값을 찾기 어려움
  - 제2 역상 저항성 (Second Preimage Resistance)
    - 특정 입력 값과 같은 해시 값을 반환하는 또 다른 입력 값을 찾기 어려움
  - 충돌 저항성 (Collision Resistance)
    - 동일한 해시 값을 가지는 두 개의 서로 다른 입력 값을 찾아내기 어려움
  - 눈사태효과 : 입력값이 조금만 변경되어도 결과값이 크게 달라짐
    - 좋은 해시 알고리즘일수록 눈사태효과가 크다

## MD5 vs SHA-1 vs SHA-256
- MD5 : 무결성을 완벽하게 보장하지 못함
- SHA-1 : 충돌이 발견된 적 있기때문에 SHA-256 이상의 알고리즘을 사용하는게 좋다.
- MD5와 SHA-1의 보안적 한계점으로 SHA-256 이상의 해시 알고리즘을 사용하는 것이 좋음

| 알고리즘 | 출력 길이 | 보안성 | 주의사항 |
| --- | --- | --- | --- |
| MD5 | 128비트 | 낮음 | 무결성을 완벽하게 보장하지 못함 |
| SHA-1 | 160비트 | 중간 | 충돌이 발견된 적 있음 |
| SHA-256 | 256비트 | 높음 | 현재 가장 많이 사용되고 있음, 충돌 미발견 |


## 레인보우 테이블 공격
1. 해시 테이블 생성
    - 가능한 많은 비밀번호 조합을 계산하고, 각 비밀번호의 해시 값을 저장
    - 이때 모든 비밀번호의 해시 값을 일일이 저장하는 대신, 해시 값을 다시 비밀번호로 변환하는 "감소 함수"를 사용하여 체인(chain)을 만드는데, 각 체인은 시작 비밀번호와 끝 해시 값만 저장한다.
2. 레인보우 테이블
    - 체인들을 저장한 자료구조가 레인보우 테이블 이 테이블은 수많은 시작 비밀번호와 끝 해시 값으로 구성된다 (해커가 미리 구성한 해시 사전)
3. 공격
    - 해커는 해시 값을 가지고 이 해시 값이 레인보우 테이블 내에 있는지 확인
    - 테이블에서 해시 값이 발견되면, 해당 체인의 시작 비밀번호를 이용해 다시 해시 값을 계산하여 일치하는 원래 비밀번호를 찾음
  
ex )
- 123456 → md5 알고리즘 → DB 저장
- 해커가 0 ~ 999999의 숫자를 MD5를 적용해서 구성된 해시사전(레인보우 테이블)을 미리 구성해 놓음
- 해커가 해시값을 알아낸 다음 해시 사전에 대입해서 원래 비밀 번호를 알아냄

- 방어 방법
  - 해시의 복잡성을 증가시키기
  - SALT 값 사용 : 비밀번호를 해시하기 전에 랜덤한 데이터를 비밀번호에 추가하여 해시 값을 생성
  - SALT 값도 털릴 수 있기 때문에 비밀번호를 어렵게 만드는 것이 중요.
 
- 레인보우 테이블 제공해주는 사이트
- https://www.md5online.org/md5-decrypt.html

## SHA(Secure Hash Algorithm)
- 미국 국가안보국(NSA)이 개발한 암호학적 해시 함수
- SHA는 1993년에 발표된 SHA-0로 시작되었으며, 이후에는 SHA-1, SHA-2, SHA-3과 같은 다양한 버전이 발표 됨
- SHA-1
  - 출력 길이: 160비트 (20바이트)
  - 2017년에 Google과 암호화 연구팀이 SHA-1의 충돌을 증명하여, 현재는 사용이 권장되지 않음
- SHA-2
  - 출력 길이: SHA-256 (256비트), SHA-512 (512비트)
  - SHA-2는 SHA-1의 보안 취약성을 보완하기 위해 개발되었음
  - 현재까지는 충돌이 발견되지 않았으며, 안전한 해시 함수로 현재 가장 많이 사용되는 해시 함수 중 하나 (SHA-256)
 
- SHA-3
  - 출력 길이: 다양한 길이 (SHA3-224, SHA3-256, SHA3-384, SHA3-512 등)
  - SHA-3는 SHA-2와는 다른 구조와 디자인을 가지고 있으며, Keccak 알고리즘을 기반으로 함

## 비둘기집의 원리
- 비둘기집의 원리 
    - n+1 개의 물체를 n개의 상자에 넣으려고 할때 최소 1개의 상자에는 2개 이상의 물체가 들어가게됨 → 충돌이 발생
    - 비둘기 집의 원리에 따라서 서로 다른 입력값의 결과가 동일한 해시 알고리즘이 존재한다.
    - 해시 알고리즘의 출력값이 유한하기 때문에, 서로 다른 입력값이 동일한 해시 값을 가질 수 있음.
    → 결국 잘만든 해시 함수라도 충돌은 불가피하다.
- MD5
    - 128비트 = 2^128 경우의 수
    - 매우 큰 숫자이지만 무한하지는 않으므로 특정 문자에 대해 MD5 알고리즘을 실행한 결과값이 같을 수도 있다. (충돌 취약성)

