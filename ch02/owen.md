# URL과 리소스
# Overview

`URL(Uniform Resource Locator)`은 인터넷의 리소스를 가리키는 표준 이름이다. URL은 전자정보 일부를 가리키고 그것이 어디에 있고 어떻게 접근할 수 있는지 알려준다.

## 인터넷의 리소스 탐색하기

사용자는 브라우저에 URL을 입력하고 브라우저는 화면 뒤에서 사용자가 원하는 리소스를 얻기 위해서 적절한 프로토콜을 사용하여 메시지를 전송한다.

![image](https://github.com/Zero-ToHero/202404-http-perfect-guide/assets/71249347/c3697821-b16c-4fad-ae52-749de243656d)

- URL의 첫 부분인 http는 스키마으로 주로 프로토콜을 의미한다.
- URL의 두 번째 부분은 웹 클라이언트가 리소스가 어디에 호스팅 되어 있는지 알려준다.
- 마지막은 리소스 경로를 의미한다.

[웹의 리소스 식별하기 - HTTP | MDN](https://developer.mozilla.org/ko/docs/Web/HTTP/Basics_of_HTTP/Identifying_resources_on_the_Web)

## URL 문법

다른 URL 스키마를 사용한다는 것이 전혀 다른 문법을 사용한다는 뜻일까? 사실은 그렇지 않다. 대부분의 URL은 일반 URL 문법을 따르며, 서로 다른 URL 스키마도 형태와 문법 면에서 매우 유사하다.

`<스키마>://<사용자 이름>:<비밀번호>@<호스트>:<포트></경로>;<파라미터>?<질의>#<프래그먼트>`

이 모든 컴포넌트를 가지는 URL은 거의 없으며 가장 중요한 세 가지 컴포넌트는 `스키마` , `호스트` , `경로` 이다.

### 스키마 : 사용할 프로토콜

스키마는 주어진 리소스에 어떻게 접근하는지 알려주는 중요한 정보다. 스키마 컴포넌트는 알파벳으로 시작해야 하고 URL의 나머지 부분들과 첫 번째 `:` 문자로 구분한다. 스킴 명은 대소문자를 가리지 않는 특징이 있다.

### 호스트와 포트

애플리케이션이 인터넷에 있는 리소스를 찾으려면, 리소스를 호스팅하고 있는 장비와 해당 서버가 어디에 있는지 알아야 한다.

URL의 `호스트`와 `포트` 컴포넌트는 그 두가지 정보를 제공해준다. 호스트 컴포넌트는 접근하려는 리소스를 가지고 있는 인터넷상의 호스트 장비를 가리킨다.

포트 컴포넌트는 서버가 열어놓은 네트워크 포트를 가리킨다.

![image](https://github.com/Zero-ToHero/202404-http-perfect-guide/assets/71249347/6a7fbc2f-19b2-4ade-ad5e-3e877950c639)

### 사용자 이름과 비밀번호

애플리케이션이 `FTP` 와 같이 사용자 이름과 비밀번호를 요구하는 URL 스키마를 사용한다면, 그 값들이 `삽입되어 있지 않을 경우` 기본 사용자 이름과 비밀 번호 값을 넣을 것이다. 예를 들어 이름 값으론 `anonymous` 가 비밀번호는 크롬브라우저 마다 가지고 있는 기본값을 사용한다.

### 경로

URL 경로 컴포넌트는 리소스가 서버의 어디에 있는지 알려준다. 해당 경로는 `계층적 파일 시스템 경로` 와 유사한 구조를 가진다.

경로 컴포넌트는 `/` 문자를 기준으로 경로조각으로 나뉜다(유닉스 파일 시스템의 파일 경로와 유사하게)

### 파라미터

URL을 사용하는 애플리케이션이 리소스에 접근하려면 프로토콜 파라미터가 필요하다. 프로토콜 파라미터가 없다면, 다른 한편에 있는 서버는 그 요청을 잘못 처리하거나 처리 하지 않을 것이다.

URL의 파라미터 컴포넌트는, 애플리케이션이 서버에 정확한 요청을 하기 위해 필요한 입력 파라미터를 받는데 사용한다.

`;` 문자로 구분하여 URL에 기술하며 이를 통해 애플리케이션이 리소스에 접근하는데 필요한 어떤 추가 정보든 전달할 수 있다.

### 질의 문자열

이는 우리가 요청해오던 URL과 거의 유사하다. 다른 점은 `물음표` 우측에 있는 값들이며 이를 질의 컴포넌트라고 부른다.

편의상 많은 게이트웨이가 `&` 로나뉜 `이름=값` 쌍 형식의 질의 문자열을 원한다.

<aside>
⚠️ 파라미터 매트릭스 vs 쿼리 파라미터
 파라미터 매트릭스는 특정 경로 요소에 적용되고, 쿼리 파라미터는 요청 전체에 적용된다

요약하자면, HTML 폼 및 단순한 단일 수준의 HTTP API에는 쿼리 파라미터를 사용하는 것이 좋다.

</aside>

[URL matrix parameters vs. query parameters](https://stackoverflow.com/questions/2048121/url-matrix-parameters-vs-query-parameters)

### 프래그먼트

리소스의 특정 부분을 가리킬 수 있도록, URL은 리소스 내의 조각을 가리킬 수 있는 `프래그먼트` 컴포넌트를 제공한다. 예를 들어 URL은 HTML 문서에 있는 특정 이미지나 일부분을 가리킬 수 있다.

이는 브라우저가 서버로부터 전체 리소스를 내려받은 후, 프래그먼트를 사용하여 보고자 하는 리소스의 일부를 보여주는 것이다.

<aside>
⚠️ 예시
[https://developer.mozilla.org/ko/docs/Web/HTTP/Basics_of_HTTP/Identifying_resources_on_the_Web#uriuniform_resource_identifier_문법](https://developer.mozilla.org/ko/docs/Web/HTTP/Basics_of_HTTP/Identifying_resources_on_the_Web#uriuniform_resource_identifier_%EB%AC%B8%EB%B2%95)

</aside>

## 단축 URL

### 상대 URL

URL은 `상대 URL`과 `절대 URL` 두 가지로 나뉜다. 우리가 지금까지 본 것들은 `절대 URL` 뿐이다.

절대 URL은 리소스에 접근하는데 필요한 모든 정보를 가지고 있다.

그와 달리 상대 URL은 모든 정보를 담고 있지는 않다. 상대 URL로 리소스에 접근하는데 필요한 모든 정보를 얻기 위해서는, `기저(base)라고 하는 다른 URL`을 사용해야 한다.

```html
기저 URL = http://www.joes-hardware.com/tools.html
<A HREF="./hammers.html"> --> 상대 URL
```

위의 경우 기저 URL을 사용하여, 상대 URL에서는 기술하지 않은 정보를 추측할 수 있다.

상대 URL을 사용하면 리소스 집합을 쉽게 변경할 수 있다. 그리고 문서 집합의 위치를 변경하더라도, 새로운 기저 URL에 의해서 해석될 것이기 때문에 잘 동작할 것이다.

**[상대 URL을 절대 URL로 변환하기]**

![image](https://github.com/Zero-ToHero/202404-http-perfect-guide/assets/71249347/45e9ad9d-eb7a-4ba3-bba2-6a334a6f8432)

### URL 확장

**호스트 명 확장**

호스트 명 확장 기능을 지원하는 브라우저는 단순한 휴리스틱만을 사용해서 입력한 호스트 명을 전체 호스트 명으로 확장할 수 있다.

예를 들어 yahoo만 입력하더라도 브라우저는 호스트 명에 자동으로 `www` 와 `.com` 을 붙여주는 것을 의미한다 어떤 브라우저는 해당 사이트를 찾지 못하면 포기하기 전에 몇 가지의 URL을 제시하기도 한다. 하지만 이런 기능은 Proxy와 같은 다른 HTTP 애플리케이션에 문제를 발생시킬 수도 있다.

**히스토리 확장**

사용자가 URL을 입력하는 시간을 줄이고자, 브라우저가 사용하는 또 다른 기술은 과거에 사용자가 방문했던 URL의 기록을 저장해 놓는 것이다.(쿠키)

이전에 방문했던 URL의 시작 부분을 입력하면, 브라우저는 이전에 방문했던 전체 경로를 보여주며 사용자는 전체 URL을 입력하는 대신 선택만 하면 된다.

## 안전하지 않은 문자

안전한 전송이란, 정보가 유실될 위험 없이 URL을 전송할 수 있다는 것을 의미한다. 전자메일에 사용되는 `SMTP` 프로토콜의 경우 특정 문자를 제거할 수도 있는 전송 방식을 사용한다.

문자가 제거되는 일을 피하고자 URL은 상대적으로 작고 일반적으로 안전한 알파벳 문자만 포함하도록 허락한다. 따라서 출력이 되지 않거나 보이지 않는 문자를 이메일 프로그램에서 사용할 수 있다고 해서, **URL에서 그런 문자들을 사용하는 것은 금지**되었다.

더해서 이스케이프라는 기능을 추가하여, 안전하지 않은 문자를 안전한 문자로 인코딩할 수 있게 하였다.

<aside>
⚠️ **이스케이프 문자**
특수한 의미를 가지는 문자를 일반적인 문자로 이식하도록 지시하는 역할

예시로 `<` 문자의 이스케이프 문자는 `&lt;` 이다.

```
&lt;p&gt;This is a paragraph&lt;/p&gt;
```

</aside>

### URL 문자 집합

컴퓨터 시스템의 기본 문자 집합은 보통 영어 중심으로 설정되어 있다. 역사적으로 많은 컴퓨터 애플리케이션이 `US-ASCII` 문자 집합을 사용했다.

이 문자는 미국인이 사용하기엔 편리하지만, 전 세계 사람들이 사용하기엔 불편함이 있다. 또한 URL이 특정 이진 데이터를 포함해야 하는 경우도 있다.

이런 지원을 위해 URL 설계자들은 URL에 이스케이프 무문자열을 쓸 수 있게 설계하였다. 이를 통해 특정 문자나 데이터를 인코딩할 수 있게 함으로써 이동성과 완성도를 높였다.

### 인코딩  체계

안전한 문자 집합을 이용하는 경우 그 표현의 한계를 넘기 위해, URL에 있는 안전하지 않은 문자들을 표현할 수있는 인코딩 방식이 고안되었다.

인코딩은 안전하지 않은 문자를 퍼센티지 기호 `%` 로 시작해 두 개의 16진수 숫자로 이루어진 `이스케이프` 문자로 바꾼다.

```html
https://namu.wiki/w/나무위키:대문
https://namu.wiki/w/%EB%82%98%EB%AC%B4%EC%9C%84%ED%82%A4:%EB%8C%80%EB%AC%B8
```

### 문자 제한

몇몇 문자는 URL 내에서 특별한 의미로 예약되어 있다. 또한 US-ASCII 의 출력 가능한 문자 집합에 포함 되어 있지 않다.

어떤 문자는 몇몇 인터넷 게이트웨이와 프로토콜에서 혼동되는 것으로 알려져 사용이 꺼려지기도 했다.

따라서 `URL에서` 예약된 문자들을 본래의 목적이 아닌 다른 용도로 사용하려면, 그 전에 반드시 인코딩해야 하는 문자들이 있다.

### 좀 더 알아보기

애플리케이션은 정해진 방식대로 구현해야 한다. 어떤 애플리케이션에 어떤 URL을 보내든지, 그 전에 클라이언트 애플리케이션에서 안전하지 않거나 제한된 문자를 변환하는 것이 좋다.

특히 해당 문자들을 직접 입력 받는 애플리케이션이야말로 어떤 문자를 인코딩해야 하는지 결정하게 가장 좋은 위치이다.

## 미래

URL의 단점은 리소스가 옮겨지면 URL을 더는 사용할 수 없다는 것이다. 그리고 그 시점에 기존 URL이 가지리키고 있던 객체를 찾을 방법이 없어진다.

이를 위해 IEFT는 객체의 위치와 상관없이, 그 객체를 가리키는 실제 객체의 이름을 사용하는 방식의 URN 이라는 새로운 표준 작업에 착수했다. URN은 객체가 옮겨지더라도 항상 객체를 가리킬 수 있는 이름을 제공한다.

### 지금 아니면, 언제?

유감스럽게도 URN으로 전환하기 위한 모든것이 준비되려면 시간이 걸리기 때문에, 당분간 URL은 계속 사용될 것이다.

URL은 그것을 대체할 수 있는 작명 스키마가 나오기 전까지는 계속 사용될 것이다. 다만 URL은 그 한계를 가진 상태에서, 그것을 해결할 수 있는 새로운 표준 같은 것들이 나오고 적용될 것이다.
