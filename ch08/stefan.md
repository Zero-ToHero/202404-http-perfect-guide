# [HTTP] 4회차(ch8)

#Daily/스터디/http

## 게이트웨이

- 등장 배경
  - 모든 리소스를 하나의 애플리케이션만으로 처리 불가
- 리소스와 애플리케이션 연결하는 역할
- 프로토콜 변환

### 프로토콜 게이트웨이

- HTTP/FTP
- HTTP/HTTPS
- HTTPS/HTTP

### 리소스 게이트웨이

- API 서버

## 터널

- HTTP를 지원하지 않는 애플리케이션에 HTTP 애플리케이션을 사용해 접근하는 방법 제공
- CONNECT 메서드로 HTTP 터널 커넥션 수립
- SSL 터널링
  - SSL이 차단되는 방화벽을 통과할 수 있도록 터널링함.
  - HTTP/HTTPS 게이트웨이
    - 클라-게이트웨이 사이에는 보안이 약한 HTTP 커넥션이 수립되어있음.
    - 프락시가 인증을 담당하기 때문에 SSL 기반의 인증 불가
    - 게이트웨이는 SSL을 지원해야함.
    - 이 상황에서 SSL 터널링 사용하면 프락시에 SSL을 구현할 필요가 없다.
      - 목적지까지 보안이 적용되어있음.
      - 프락시는 그냥 암호화된 데이터를 전달하기만 하면 된다.

## 릴레이

- HTTP 명세를 완전히 준수하지는 않는 간단한 HTTP 프락시
- Connection헤더를 제대로 처리하지 못하는 경우, 문제 발생
  1. 클라가 서버로 Connection: Keep-Alive 헤더 전송
  2. 클라는 요청 전송 후, 서버의 응답을 기다림.
  3. 릴레이는 Connection 헤더를 이해하지 못해서 서버로 넘긴다.(터널링)
  4. 근데 Connection헤더는 연쇄적으로 전달할 수가 없다.
  5. 서버는 웹 클라가 아니라 릴레이가 keep alive하고 싶다는 걸로 착각한다.
  6. 서버는 Connection: Keep-Alive 헤더로 응답한다.
  7. 이후 서버는 릴레이와 keep alive 통신 규칙에 맞게 동작하는데 릴레이는 keep alive에 대해 아무것도 모르는 상황이다.
  8. 릴레이는 서버가 커넥션을 끊길 바라지만 서버는 커넥션을 끊어주질 않음.
  9. 서버는 릴레이가 커넥션을 계속 맺기를 바라는 걸로 착각.
  10. 브라우저는 그냥 계속 대기하게 된다.
